The program begins by importing mysql.connector and pandas.
Then establish a connection to the local MySQL server using the host, username, and password, and creates a cursor object to execute SQL commands.
It creates a database named movie_analysis if it does not already exist and selects it for use, then creates a table called movies with columns for id, title, budget, revenue, vote_average, and genre.
The script reads a CSV file named movies.csv into a pandas DataFrame, selects only the required columns, and removes any missing values.
It then iterates through each row of the DataFrame and inserts the data into the MySQL table using parameterized SQL queries, followed by committing the transaction to save the records. After inserting the data, it retrieves all records from the movies table using a SELECT query and loads them back into a DataFrame. The program filters out rows where budget or revenue is less than or equal to zero and creates a new column called success, which is True when revenue is greater than budget. It then calculates and prints the total number of movies, the success rate percentage, the average budget, the average revenue, and the average vote average. Finally, it groups the data by genre to compute the average revenue per genre in descending order and closes the cursor and database connection to release resources.
